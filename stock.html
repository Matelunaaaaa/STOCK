<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>M√≥dulo de Stock - Equipos Computacionales</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>Gesti√≥n de Stock TechStock</h1>
    </header>

    <nav>
      <button onclick="cerrarSesion()">Cerrar sesi√≥n</button>
    </nav>

    <div class="container">
      <div class="search-bar">
        <div class="search-input">
          <label for="product-search">Buscar por nombre:</label>
          <input
            type="text"
            id="product-search"
            placeholder="Nombre del producto..."
          />
        </div>
        <button class="search-button" id="btn-search">Buscar</button>
      </div>

      <table id="stock-table">
        <thead>
          <tr>
            <th>Nombre del Producto</th>
            <th>Categor√≠a</th>
            <th>Stock</th>
            <th>Proveedor</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Laptop HP Pavilion 15</td>
            <td>Laptops</td>
            <td class="stock-value">12</td>
            <td>HP Chile</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr class="stock-warning">
            <td>Monitor LG UltraGear 27"</td>
            <td>Perif√©ricos</td>
            <td class="stock-value">5</td>
            <td>Distribuidora LG</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr class="stock-critical">
            <td>Tarjeta Gr√°fica NVIDIA RTX 3060</td>
            <td>Componentes</td>
            <td class="stock-value">2</td>
            <td>TechImport</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>Teclado Mec√°nico Logitech G Pro</td>
            <td>Perif√©ricos</td>
            <td class="stock-value">15</td>
            <td>Logitech Chile</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>Disco SSD Kingston 480GB</td>
            <td>Componentes</td>
            <td class="stock-value">23</td>
            <td>Importadora Kingston</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>Memoria RAM Corsair 16GB DDR4</td>
            <td>Componentes</td>
            <td class="stock-value">18</td>
            <td>TechImport</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>Mouse Inal√°mbrico Logitech MX</td>
            <td>Perif√©ricos</td>
            <td class="stock-value">9</td>
            <td>Logitech Chile</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
          <tr class="stock-warning">
            <td>Impresora HP LaserJet Pro</td>
            <td>Perif√©ricos</td>
            <td class="stock-value">4</td>
            <td>HP Chile</td>
            <td>
              <div class="stock-controls">
                <button class="btn-decrement">-</button>
                <button class="btn-increment">+</button>
                <button class="btn-edit">‚úèÔ∏è</button>
                <button class="btn-delete">üóëÔ∏è</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <div style="text-align: right; margin-top: 20px">
        <button id="btn-add-product" class="search-button">
          Agregar Producto
        </button>
        <button id="btn-save-changes" class="search-button">
          Guardar Cambios
        </button>
      </div>
    </div>

    <footer>
      <p>
        &copy; 2025 TechStock - Sistema de Inventario para Equipos
        Computacionales. Todos los derechos reservados.
      </p>
    </footer>

    <script>
      // Verificar si el usuario est√° logueado
      if (!localStorage.getItem('usuarioLogueado')) {
        window.location.href = 'home.html'; // redirige al login si no inici√≥ sesi√≥n
      }

      // Funcionalidad para cerrar sesi√≥n
      function cerrarSesion() {
        localStorage.removeItem('usuarioLogueado'); // eliminar el usuario logueado
        window.location.href = 'home.html'; // redirigir al login
      }

      // Funcionalidad para filtrar productos por nombre
      document
        .getElementById("btn-search")
        .addEventListener("click", function () {
          const searchTerm = document
            .getElementById("product-search")
            .value.toLowerCase();
          const rows = document.querySelectorAll("#stock-table tbody tr");

          rows.forEach((row) => {
            const productName = row.cells[0].textContent.toLowerCase();
            if (productName.includes(searchTerm)) {
              row.style.display = "";
            } else {
              row.style.display = "none";
            }
          });
        });

      // Tambi√©n filtrar al presionar Enter en el campo de b√∫squeda
      document
        .getElementById("product-search")
        .addEventListener("keyup", function (event) {
          if (event.key === "Enter") {
            document.getElementById("btn-search").click();
          }
        });

      // Funcionalidad para incrementar stock
      document.querySelectorAll(".btn-increment").forEach((button) => {
        button.addEventListener("click", function () {
          const row = this.closest("tr");
          const stockCell = row.querySelector(".stock-value");
          let currentStock = parseInt(stockCell.textContent);
          stockCell.textContent = currentStock + 1;

          // Actualizar clases de advertencia basadas en el nuevo valor de stock
          updateStockWarningClass(row, currentStock + 1);
        });
      });

      // Funcionalidad para decrementar stock
      document.querySelectorAll(".btn-decrement").forEach((button) => {
        button.addEventListener("click", function () {
          const row = this.closest("tr");
          const stockCell = row.querySelector(".stock-value");
          let currentStock = parseInt(stockCell.textContent);

          if (currentStock > 0) {
            stockCell.textContent = currentStock - 1;

            // Actualizar clases de advertencia basadas en el nuevo valor de stock
            updateStockWarningClass(row, currentStock - 1);
          }
        });
      });

      // Funci√≥n para actualizar las clases de advertencia de stock
      function updateStockWarningClass(row, stockValue) {
        row.classList.remove("stock-warning", "stock-critical");

        if (stockValue <= 2) {
          row.classList.add("stock-critical");
        } else if (stockValue <= 5) {
          row.classList.add("stock-warning");
        }
      }

      // Funcionalidad para editar producto
      document.querySelectorAll(".btn-edit").forEach((button) => {
        button.addEventListener("click", function () {
          alert("Funci√≥n de edici√≥n en desarrollo.");
        });
      });

      // Funcionalidad para eliminar producto
      document.querySelectorAll(".btn-delete").forEach((button) => {
        button.addEventListener("click", function () {
          if (confirm("¬øEst√° seguro de que desea eliminar este producto?")) {
            this.closest("tr").remove();
          }
        });
      });

      // Funcionalidad para agregar nuevo producto
      document.getElementById("btn-add-product").addEventListener("click", function () {
        alert("Funci√≥n de agregar producto en desarrollo.");
      });

      // Funcionalidad para guardar cambios
      document.getElementById("btn-save-changes").addEventListener("click", function () {
        alert("Funci√≥n de guardar cambios en desarrollo.");
      });
    </script>
  </body>
</html>
